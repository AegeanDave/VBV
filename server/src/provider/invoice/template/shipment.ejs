<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Beautiful Table</title>
		<style>
			table {
				width: 100%;
				border-collapse: collapse;
				margin-top: 10px;
			}
			th,
			td {
				border: 1px solid #ddd;
				padding: 6px 8px;
				text-align: left;
			}
			th:nth-child(1) {
				width: 5%; /* Set the desired width */
			}
			th:nth-child(2) {
				width: 12%; /* Set the desired width */
			}
			th:nth-child(3) {
				width: 26%; /* Set the desired width */
			}
			th:nth-child(4) {
				width: 20%; /* Set the desired width */
			}
			th:nth-child(7) {
				width: 20%; /* Set the desired width */
			}
		</style>
	</head>
	<body>
		<h3>发货单</h3>
		<table>
			<thead>
				<tr>
					<th>序号</th>
					<th>订单号</th>
					<th>收件人地址</th>
					<th>产品名称</th>
					<th>数量</th>
					<th>运单公司</th>
					<th>运单号</th>
				</tr>
			</thead>
			<tbody>
				<% data.forEach((order, orderIndex)=> { %> <%
				order.orderDetails.forEach((item, index) => { %>
				<tr>
					<% if(index===0) {%>
					<td rowspan="<%= order.orderDetails.length %>">
						<%= orderIndex+1 %>
					</td>
					<td rowspan="<%= order.orderDetails.length %>">
						<%= order.orderNumber %>
					</td>
					<% if (order.address.quickInput) { %>
					<td rowspan="<%= order.orderDetails.length %>">
						<%= order.address.quickInput %>
					</td>
					<% } else { %>
					<td rowspan="<%= order.orderDetails.length %>">
						<%= order.address.recipient + ' ' + order.address.phone + ' '+
						order.address.street + ', ' + order.address.city +
						order.address.state + ' '+order.address.country %>
					</td>
					<% } %> <% } else { %> <% } %>
					<td><%= item.productInfo.name %></td>
					<td><%= item.quantity %></td>
					<td></td>
					<td></td>
				</tr>
				<% }) %> <% }) %>
			</tbody>
		</table>
	</body>
</html>
